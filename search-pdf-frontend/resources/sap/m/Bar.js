/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * (c) Copyright 2009-2013 SAP AG or an SAP affiliate company. 
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
jQuery.sap.declare("sap.m.Bar");jQuery.sap.require("sap.m.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.m.Bar",{metadata:{library:"sap.m",properties:{"enableFlexBox":{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},"translucent":{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{"contentLeft":{type:"sap.ui.core.Control",multiple:true,singularName:"contentLeft"},"contentMiddle":{type:"sap.ui.core.Control",multiple:true,singularName:"contentMiddle"},"contentRight":{type:"sap.ui.core.Control",multiple:true,singularName:"contentRight"}}}});
sap.m.Bar.prototype.onBeforeRendering=function(){this._removeAllListeners()};
sap.m.Bar.prototype.onAfterRendering=function(){this._handleResize()};
sap.m.Bar.prototype.exit=function(){this._removeAllListeners();if(this._oflexBox){this._oflexBox.destroy();this._oflexBox=null}this.$midBarPH=null;this.$rightBar=null;this.$leftBar=null};
sap.m.Bar._aResizeHandlers=["_sResizeListenerId","_sResizeListenerIdMid","_sResizeListenerIdRight","_sResizeListenerIdLeft"];
sap.m.Bar.prototype._removeAllListeners=function(){var t=this;sap.m.Bar._aResizeHandlers.forEach(function(i){t._removeListenerFailsave(i)})};
sap.m.Bar.prototype._removeListenerFailsave=function(l){if(this[l]){sap.ui.core.ResizeHandler.deregister(this[l]);this[l]=null}};
sap.m.Bar.prototype._handleResize=function(){this._removeAllListeners();var i=this.getId(),c=!!this.getContentLeft().length,C=!!this.getContentMiddle().length,b=!!this.getContentRight().length;if(!c&&!C&&!b){return}this.$leftBar=jQuery.sap.byId(i+"-BarLeft");this.$rightBar=jQuery.sap.byId(i+"-BarRight");this.$midBarPH=jQuery.sap.byId(i+"-BarPH");this._updatePosition(c,C,b);this._sResizeListenerId=sap.ui.core.ResizeHandler.register(this.getDomRef(),jQuery.proxy(this._handleResize,this));if(this.getEnableFlexBox()){return}if(c){this._sResizeListenerIdLeft=sap.ui.core.ResizeHandler.register(this.$leftBar[0],jQuery.proxy(this._handleResize,this))}if(C){this._sResizeListenerIdMid=sap.ui.core.ResizeHandler.register(this.$midBarPH[0],jQuery.proxy(this._handleResize,this))}if(b){this._sResizeListenerIdRight=sap.ui.core.ResizeHandler.register(this.$rightBar[0],jQuery.proxy(this._handleResize,this))}};
sap.m.Bar.prototype._updatePosition=function(c,C,b){var u=this.getEnableFlexBox();if(!c&&!b){this.$midBarPH.css({width:'100%'});return}if(c&&!C&&!b){this.$leftBar.css({width:'100%'});return}if(!c&&!C&&b){this.$rightBar.css({width:'100%'});return}var B=this.$().outerWidth(true);this.$rightBar.css({width:""});this.$leftBar.css({width:""});this.$midBarPH.css({position:"",width:"",visibility:'hidden'});var r=this.$rightBar.outerWidth(true);if(r>B){if(c){this.$leftBar.css({width:"0px"})}if(C){this.$midBarPH.css({width:"0px"})}this.$rightBar.css({width:B+"px"});return}var l=this._getBarContainerWidth(this.$leftBar);if(B<(l+r)){l=B-r;this.$leftBar.width(l);this.$midBarPH.width(0);return}var m=this._getMidBarCss(r,B,l);this.$midBarPH.css(m)};
sap.m.Bar.prototype._getMidBarCss=function(r,b,l){var m=this.$midBarPH.outerWidth(true),M=this.$midBarPH.position();var R=sap.ui.getCore().getConfiguration().getRTL(),L=R?"right":"left",o={visibility:""};if(this.getEnableFlexBox()){m=b-l-r-parseInt(this.$midBarPH.css('margin-left'),10)-parseInt(this.$midBarPH.css('margin-right'),10);o=jQuery.extend(o,{position:'absolute',width:m+"px"});o[L]=l;return o}var s=b-l-r;var i=(b/2)-(m/2);var a=l>i;var c=(b/2)+(m/2);var d=(b-r)<c;if(s>0&&(a||d)){o=jQuery.extend(o,{position:'absolute',width:s+"px"});o.left=R?r:l}var $=jQuery.sap.byId(this.getId()+"-BarMiddle"),e=$.outerWidth(true);if(o.width>e){o.width=e}return o};
sap.m.Bar.prototype._getBarContainerWidth=function($){var i,c=0,C=$.children(),a=0;if(sap.ui.Device.browser.webkit){for(i=0;i<C.length;i++){a+=jQuery(C[i]).outerWidth(true)}c=$.outerWidth(true)}else{var o;for(i=0;i<C.length;i++){o=window.getComputedStyle(C[i]);if(o.width=="auto"){a+=jQuery(C[i]).width()+1}else{a+=parseFloat(o.width)}a+=parseFloat(o.marginLeft);a+=parseFloat(o.marginRight);a+=parseFloat(o.paddingLeft);a+=parseFloat(o.paddingRight)}var b=window.getComputedStyle($[0]);c+=parseFloat(b.width);c+=parseFloat(b.marginLeft);c+=parseFloat(b.marginRight);c+=parseFloat(b.paddingLeft);c+=parseFloat(b.paddingRight)}if(c<a){c=a}return c};
